- type: custom:dwains-flexbox-card
# items_classes: 'col-xs-12 col-sm-6 col-sm-6 col-md-3'
  items_classes: 'col-xs-12 col-sm-3 col-sm-6 col-md-6'
  padding: true
  cards:
      - type: grid
        cards:
          - type: gauge
            entity: input_number.mem_temp_piscine
            min: 0
            max: 40
            severity:
              green: 27
              yellow: 0
              red: 30
            name: Temp Eau
            needle: true
          - type: gauge
            entity: sensor.vp2_temp_out
            max: 45
            name: T° Ext
            min: -10
            severity:
              green: 15
              yellow: -10
              red: 30
            needle: true
          - type: gauge
            entity: sensor.pression_filtre
            min: 0
            max: 2
            severity:
              green: 0
              yellow: 0.9
              red: 1
            name: P Filtre
            unit: B
            needle: true
          - type: gauge
            entity: sensor.ph_piscine_ph
            min: 6
            max: 9
            name: pH
            severity:
              green: 7.1
              yellow: 6
              red: 7.7
            needle: true
          - type: gauge
            entity: sensor.orp_piscine_orp
            min: 0
            name: ORP
            severity:
              green: 750
              yellow: 0
              red: 900
            needle: true
            max: 1009
          - type: gauge
            entity: sensor.e_fc
            min: 0
            max: 10
            name: Fc
            needle: true
          - type: gauge
            entity: input_number.temps_cartouche_chlore
            min: 0
            max: 70
            name: Cart Chlore
            severity:
              green: 0
              yellow: 30
              red: 60
            needle: true
          - type: gauge
            entity: sensor.pzem_pisc_puissance
            min: 0
            max: 900
            name: Puissance
            severity:
              green: 0
              yellow: 350
              red: 800
            needle: true
          - aspect_ratio: 1
            color: auto
            entity: pool_pump.next_run_schedule
            name: Tranche Horaire
            hold_action:
              action: more-info
            show_state: true
            type: custom:button-card
          - aspect_ratio: 1
            color: auto
            entity: binary_sensor.pool_pump_running
            name: Ppe Filtre
            hold_action:
              action: more-info
            show_last_changed: true
            show_state: true
            state:
              - styles:
                  icon:
                    - color: red
                value: 'off'
              - styles:
                  icon:
                    - color: green
                value: 'on'
            type: custom:button-card
          - aspect_ratio: 1
            color: auto
            entity: automation.piscine_injection_v2
            name: Injection pH
            hold_action:
              action: more-info
            show_last_changed: true
            show_state: true
            state:
              - styles:
                  icon:
                    - color: red
                value: 'off'
              - styles:
                  icon:
                    - color: green
                value: 'on'
            type: custom:button-card
          - aspect_ratio: 1
            color: auto
            entity: cover.volet_piscine
            name: Volet Piscine
            hold_action:
              action: more-info
            show_last_changed: true
            show_state: true
            confirmation:
              text: >-
                [[[ return `Etes vous sur ${entity.attributes.friendly_name}?`
                ]]]
            state:
              - styles:
                  icon:
                    - color: red
                value: open
              - styles:
                  icon:
                    - color: green
                value: closed
            type: custom:button-card
        square: true
      - type: vertical-stack
        cards:
          - title: <- 3 jours
            entities:
              - entity: switch.pool_pump_switch
                name: Ppe filtre
              - entity: switch.cde_ev_eau
                name: Ev Eau
              - entity: switch.cde_traitement
                name: Ppe pH
              - entity: switch.cde_ppe_chlore
                name: Ppe Ch
            type: history-graph
            hours_to_show: 72
            refresh_interval: 0
      - entities:
          - entity: input_select.pool_pump_mode
            name: Mode de Fonctionnement
          - entities:
              - entity: sensor.pression_piscine_p
                name: Pression
              - entity: sensor.temp_piscine
                name: T Eau
              - entity: sensor.pool_water_temperature
                name: T° At
              - entity: sensor.vp2_temp_out
                name: T Ext
            entity: sensor.pression_piscine_p
            icon: mdi:chart-bell-curve
            name: Mesures
            show_state: false
            type: custom:multiple-entity-row
          - entities:
              - entity: switch.cde_traitement
                name: Ppe
              - entity: input_boolean.regul_ph
                name: Val Ph
              - entity: sensor.ph_ezo
                name: Ezo
                unit: false
              - entity: sensor.ph_piscine_ph
                name: Filtré
                unit: false
              - entity: input_number.ph_cible
                name: Cible
                unit: false
              - entity: sensor.ph_volume_restant_bidon
                name: Vol Bid
                unit: false
            entity: input_boolean.regul_ph
            icon: mdi:chart-bell-curve
            name: Ph
            show_state: false
            type: custom:multiple-entity-row
          - entities:
              - entity: switch.cde_ppe_chlore
                name: Ppe
              - entity: input_boolean.regul_chlore
                name: Val Ph
              - entity: sensor.orp_ezo
                name: Ezo
                unit: false
              - entity: sensor.orp_piscine_orp
                name: Filtré
                unit: false
              - entity: input_number.chlore_cible
                name: Cible
                unit: false
              - entity: sensor.chlore_volume_restant_bidon
                name: Vol Bid
                unit: false
            entity: input_boolean.regul_chlore
            icon: mdi:chart-bell-curve
            name: Chlore/ORP
            show_state: false
            type: custom:multiple-entity-row
          - entities:
              - entity: input_number.temps_cartouche_chlore
                name: Tps Cartouche
                unit: false
              - entity: input_number.chlore_seuil_max_utilisation
                name: Tps Max
            entity: input_number.temps_cartouche_chlore
            icon: mdi:chart-bell-curve
            name: Chlore cart
            show_state: false
            type: custom:multiple-entity-row
          - entities:
              - entity: pool_pump.next_run_schedule
                name: 'A venir '
              - entity: sensor.heure_pivot_piscine
                name: Heure pivot
            entity: pool_pump.next_run_schedule
            icon: mdi:clock
            name: Tranche horaire
            show_state: false
            type: custom:multiple-entity-row
          - entities:
              - entity: pool_pump.total_daily_filtering_duration
                name: Durée Calculée
              - entity: sensor.pool_pump_running_today
                name: Fonct. Jour
              - entity: binary_sensor.pool_pump_running
                name: Etat
            entity: sensor.pool_pump_running_today
            icon: mdi:pump
            name: Pompe Filtration
            show_state: false
            type: custom:multiple-entity-row
          - entities:
              - entity: sensor.pzem_pisc_puissance
                name: Puissance
              - entity: sensor.pzem_pisc_courant
                name: Intensité
            entity: sensor.pzem_pisc_puissance
            icon: mdi:flash
            name: Conso Elec
            show_state: false
            type: custom:multiple-entity-row
          - entities:
              - entity: input_boolean.piscine_mode_hivernage
                name: Mode Hiv
              - entity: input_datetime.heure_ma_pump_pisc_hiv
                name: MaPpe
              - entity: input_datetime.heure_at_pump_pisc_hiv
                name: AtPpe
              - entity: input_boolean.hors_gel
                name: HG si actif
              - entity: input_number.hors_gel_inf
                name: T°Inf
              - entity: input_number.hors_gel_sup
                name: T°Sup
            entity: input_boolean.hors_gel
            icon: mdi:snowflake-alert
            name: Hiver
            show_state: false
            type: custom:multiple-entity-row
          - entities:            
              - entity: input_boolean.volet_piscine_auto
                name: Auto
              - entity: cover.volet_piscine
                name: Volet
              - entity: input_datetime.heure_ouv_volet_pisc
                name: Ouv
              - entity: input_datetime.heure_ferm_volet_pisc
                name: Ferm
            entity: cover.volet_piscine
            icon: mdi:window-shutter
            name: Volet piscine
            show_state: false
            type: custom:multiple-entity-row
          - entities:
              - entity: sensor.ev_eau_sur_7j
                name: 7J
              - entity: sensor.ev_eau_tps_ouverture_jour
                name: 1J
              - entity: switch.cde_ev_eau
                name: Cde EV
              - entity: binary_sensor.tp_plein_lsh
                name: Niv H
              - entity: binary_sensor.tp_plein_lsl
                name: Niv B
            entity: sensor.ev_eau_tps_ouverture_jour
            icon: mdi:water
            name: Appoint Eau
            show_state: false
            type: custom:multiple-entity-row
          - entities:
              - label: Filtration
                type: section
              - entity: input_number.mem_temp_piscine
              - label: Volet
                type: section
              - entity: input_boolean.volet_piscine_auto
              - entity: input_datetime.heure_ouv_volet_pisc
              - entity: input_datetime.heure_ferm_volet_pisc
              - label: Hiver
                type: section
              - entity: input_boolean.piscine_mode_hivernage
              - entity: input_datetime.heure_ma_pump_pisc_hiv
                name: Heure Marche Ppe
              - entity: input_datetime.heure_at_pump_pisc_hiv
                name: Heure Arret Ppe
              - entity: input_boolean.hors_gel
                name: Hors Gel si Actif
              - entity: input_number.hors_gel_inf
              - entity: input_number.hors_gel_sup
              - label: Chlore
                type: section
              - entity: input_number.temps_cartouche_chlore
              - entity: input_number.chlore_seuil_max_utilisation
              - label: pH
                type: section
              - entity: sensor.ph_ezo
                name: pH Ezo
              - entity: sensor.ph_piscine_ph
                name: pH filtré
              - entity: input_number.ph_memoire
              - entity: sensor.ph_stat
                name: pH Statistiques
              - entity: input_boolean.regul_ph
              - entity: input_number.ph_cible
              - entity: input_number.ph_hysteresis
              - entity: sensor.ph_derniere_heure
              - entity: sensor.ph_derniere_48h
              - entity: input_number.ph_debit_ppe
              - entity: input_number.ph_concentration
              - entity: input_number.ph_vol_bidon
              - entity: input_number.ph_seuil_bas_bidon
              - entity: input_number.ph_vol_injecte
              - entity: binary_sensor.ph_niveau_bas_bidon
              - entity: sensor.ph_tps_inject_mn
              - entity: sensor.ph_tps_inject_s
              - entity: input_number.ph_duree_inject_mn
              - entity: input_number.ph_duree_inject_s
              - label: Chlore/ORP
                type: section
              - entity: sensor.orp_ezo
                name: ORP Ezo
              - entity: sensor.orp_piscine_orp
                name: ORP filtré
              - entity: input_number.orp_memoire
              - entity: sensor.orp_stat
                name: ORP Statistiques
              - entity: input_boolean.regul_chlore
              - entity: input_number.orp_cible
              - entity: input_number.orp_hysteresis
              - entity: sensor.chlore_derniere_heure
              - entity: sensor.chlore_derniere_48h
              - entity: input_number.chlore_debit_ppe
              - entity: input_number.chlore_concentration
              - entity: input_number.chlore_vol_bidon
              - entity: input_number.chlore_seuil_bas_bidon
              - entity: input_number.chlore_vol_injecte
              - entity: binary_sensor.chlore_niveau_bas_bidon
              - entity: sensor.chlore_tps_inject_mn
              - entity: sensor.chlore_tps_inject_s
              - entity: input_number.chlore_duree_inject_mn
              - entity: input_number.chlore_duree_inject_s
              - label: Commutateurs
                type: section
              - entity: cover.volet_piscine
                name: Couverture flottante
              - entity: input_boolean.eclairage_piscine
                name: Eclairage
              - entity: input_boolean.ev_eau_piscine
                name: EV Eau appoint en auto si actif
            show_state: false
            head:
              label: PARAMETRES & COMMUTATEURS
              type: section
            padding: 0
            type: custom:fold-entity-row
          - entities:
              - entity: switch.pool_pump_switch
                name: Relais Pompe Filtre
              - entity: switch.cde_traitement
                name: Relais pH
              - entity: switch.cde_ppe_chlore
                name: Relais Chlore
              - entity: switch.cde_volet_ouverture
                name: Relais Ouverture Volet
              - entity: switch.cde_volet_fermeture
                name: Relais fermeture Volet
              - entity: switch.cde_eclairage
                name: Relais Eclairage
              - entity: switch.cde_ev_eau
                name: EV Eau
            show_state: false
            head:
              label: COMMANDES DIRECTES
              type: section
            padding: 0
            type: custom:fold-entity-row
        style: |
          ha-card {
            border: solid 2px var(--primary-color);
          }
        show_header_toggle: false
        title: Piscine
        type: entities
      - type: entities
        entities:
          - entity: input_boolean.ev_eau_piscine
            name: Validation Appoint eau
          - entity: automation.piscine_ev_appoint_eau
            name: Autom Appoint Eau On
          - entity: cover.volet_piscine
          - entity: sensor.ev_eau_tps_ouverture_jour
          - entity: sensor.ev_eau_sur_7j
          - entity: switch.cde_ev_eau
          - entity: binary_sensor.tp_plein_lsh
            name: Niveau Haut Régulation (Inactif=recouvert)
          - entity: binary_sensor.tp_plein_lsl
            name: Niveau Tres Bas (Inactif=recouvert)
          - entity: binary_sensor.pool_pump_running
        title: EV Appoint eau
        show_header_toggle: false